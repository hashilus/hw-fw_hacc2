# HACC2 - Hashilus Air Control Controller 2

## 概要
HACC2は、Hashilusの空気制御システムのコントローラーです。Mbed OSを使用して実装されており、UDP経由でコマンドを受け付け、SSRとRGB LEDを制御します。

## バージョン
- 現在のバージョン: 2.0.0
- 主な変更点:
  - ネットワーク接続の安定性向上
  - パケット処理の最適化
  - バッファサイズの拡大（8KB）
  - パフォーマンス監視機能の追加

## ハードウェア要件
- Mbed対応ボード
- イーサネットインターフェース
- SSRドライバー（4チャンネル）
- RGB LEDドライバー（3チャンネル）

## ソフトウェア要件
- Mbed OS 6.x
- コンパイラ: ARM GCC

## ビルド方法
```bash
mbed compile -m <TARGET> -t GCC_ARM
```

## 設定
### ネットワーク設定
- DHCP: デフォルトで有効
- 静的IP: 設定可能
- UDPポート: デフォルト5555

### デバッグレベル
- 0: エラーのみ
- 1: 基本情報
- 2: 詳細情報

## UDPコマンド
### 基本コマンド
- `info`: デバイス情報の取得
  - 応答: `info,<デバイス名>,2.0.0,OK`

### SSR制御
- `set <id>,<value>`: SSRの制御
  - id: 0-4 (0は全チャンネル)
  - value: 0-100 (0=OFF, 100=ON)
  - 例: `set 1,50` (チャンネル1を50%で制御)

- `freq <id>,<value>`: PWM周波数の設定
  - id: 0-4 (0は全チャンネル)
  - value: 1-10 (Hz)
  - 例: `freq 0,5` (全チャンネルを5Hzに設定)

- `get <id>`: SSRの状態取得
  - id: 1-4
  - 応答: `get <id>,<duty>,<freq>,OK`

### RGB LED制御
- `rgb <id>,<r>,<g>,<b>`: RGB LEDの制御
  - id: 0-3 (0は全LED)
  - r,g,b: 0-255
  - 例: `rgb 1,255,0,0` (LED1を赤色に設定)

- `rgbget <id>`: RGB LEDの状態取得
  - id: 1-3
  - 応答: `rgbget <id>,<r>,<g>,<b>,OK`

### 特殊コマンド
- `mist <duration>`: ミスト制御
  - duration: 0-10000 (ミリ秒)
  - 例: `mist 1000` (1秒間ミストを制御)

- `air <level>`: エアー制御
  - level: 0-2 (0=OFF, 1=LED2のみ, 2=両方)
  - 例: `air 2` (両方のLEDをON)

## パフォーマンス監視
- パケット処理時間の統計情報
  - 平均処理時間
  - 最大処理時間
  - 処理パケット数
- 100パケットごとに統計情報を表示

## エラー処理
- ネットワーク切断時の自動再接続
- ソケットエラー時の自動再初期化
- パケット処理時間の監視と警告

## ライセンス
- プロプライエタリ

## 作者
- Hashilus 